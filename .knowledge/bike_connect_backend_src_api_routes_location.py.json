{"is_source_file": true, "format": "Python", "description": "This file defines API endpoints related to user location updates and nearby cyclist searches. It includes functions for updating user location in the database and fetching nearby users based on distance calculations using the haversine formula.", "external_files": ["src.api.db", "src.api.deps", "src.api.schemas"], "external_methods": ["get_current_user", "locations", "profiles", "session_scope", "insert", "select", "update"], "published": ["router"], "classes": [{"name": "NearbyUserItem", "description": "Data model representing an individual nearby user with their details and distance."}, {"name": "NearbyResponse", "description": "Response model encapsulating a list of nearby users."}], "methods": [{"name": "float _haversine_km(lat1: float, lng1: float, lat2: float, lng2: float)", "description": "Calculates the approximate distance in kilometers between two geographical points specified by latitude and longitude.", "scope": "", "scopeKind": ""}, {"name": "update_location(req: LocationUpdateRequest, current_user: dict = Depends(get_current_user))", "description": "API endpoint to update the current user's location in the database.", "scope": "", "scopeKind": ""}, {"name": "nearby_search( lat: float = Query(..., description=\"Latitude\"), lng: float = Query(..., description=\"Longitude\"), radius_km: float = Query(5.0, gt=0, le=200, description=\"Search radius in kilometers\"), current_user: dict = Depends(get_current_user), )", "description": "API endpoint to search and return cyclists within a specified radius of given coordinates.", "scope": "", "scopeKind": ""}], "calls": ["select", "update", "insert", "db.execute", "math.radians", "math.sin", "math.cos", "math.sqrt", "math.atan2", "session_scope", "get_current_user"], "search-terms": ["routes_location.py", "haversine", "nearby_search", "update_location"], "state": 2, "file_id": 21, "knowledge_revision": 39, "git_revision": "", "ctags": [{"_type": "tag", "name": "_haversine_km", "path": "/home/kavia/workspace/code-generation/cyclist-connect-325111-325120/bike_connect_backend/src/api/routes_location.py", "pattern": "/^def _haversine_km(lat1: float, lng1: float, lat2: float, lng2: float) -> float:$/", "language": "Python", "typeref": "typename:float", "kind": "function", "signature": "(lat1: float, lng1: float, lat2: float, lng2: float)"}, {"_type": "tag", "name": "nearby_search", "path": "/home/kavia/workspace/code-generation/cyclist-connect-325111-325120/bike_connect_backend/src/api/routes_location.py", "pattern": "/^def nearby_search($/", "language": "Python", "kind": "function", "signature": "( lat: float = Query(..., description=\"Latitude\"), lng: float = Query(..., description=\"Longitude\"), radius_km: float = Query(5.0, gt=0, le=200, description=\"Search radius in kilometers\"), current_user: dict = Depends(get_current_user), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/cyclist-connect-325111-325120/bike_connect_backend/src/api/routes_location.py", "pattern": "/^router = APIRouter(tags=[\"Location & Nearby\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_location", "path": "/home/kavia/workspace/code-generation/cyclist-connect-325111-325120/bike_connect_backend/src/api/routes_location.py", "pattern": "/^def update_location(req: LocationUpdateRequest, current_user: dict = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(req: LocationUpdateRequest, current_user: dict = Depends(get_current_user))"}], "hash": "00442e5eefe5bbbdabffadbcbd8b07d3", "format-version": 4, "code-base-name": "bike_connect_backend", "filename": "bike_connect_backend/src/api/routes_location.py", "fields": [{"name": "router = APIRouter(tags=[\"Location & Nearby\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"39": ""}]}